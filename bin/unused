#!/usr/bin/env node

var fs = require('fs');

var argv = require('optimist')
  .demand('path')
  .argv;

var unused = require('../');

var unused_vars = unused(fs.readFileSync(argv.path, 'utf8'));

// sort by line number
unused_vars.sort(function(left, right) {
    return left.loc.line - right.loc.line;
});

if (unused_vars.lenth === 0) {
    process.exit(0);
}

unused_vars.forEach(function(variable) {
    console.log('%s - on line %s', variable.name, variable.loc.line);
});

// exit with -1 to indicate unused vars exist
// useful if used as a git commit hook or other script to detect failure
// failure is defined by the existence of unused variables
process.exit(-1);

// vim: ft=javascript
